FROM nvidia/cuda:12.1.0-runtime-ubuntu22.04

# Install Python and pip
RUN apt-get update && apt-get install -y python3 python3-pip git && \
    rm -rf /var/lib/apt/lists/*

# Install vLLM and dependencies
# We install a specific version known to be stable or just latest
RUN pip3 install --no-cache-dir "vllm>=0.6.3" "transformers>=4.46.0" google-cloud-storage

# Copy entrypoint script
COPY img2latex_vlm/serve_entrypoint.py /app/serve_entrypoint.py

ENTRYPOINT ["python3", "/app/serve_entrypoint.py"]
